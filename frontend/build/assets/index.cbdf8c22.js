import{d as N,j as M,C as p,D as V,aE as k,aH as s,aI as l,F as W,aF as x,aM as w,aN as u,aK as le,b5 as se,b6 as ee,aY as j,g as oe,r as E,o as re,G as y,u as P,aR as G,b7 as ie,X as de,bj as me,bk as ce,ba as H,bb as K,be as te,bf as ae}from"./arco.a9e9ea8e.js";import{B as ue,_ as pe}from"./banner.bab2aea3.js";import{F as fe}from"./index.fed99cd4.js";import{v as J,u as q,b as _e,k as ge,c as ve,_ as R,g as L,a as he,i as ye,l as A,m as be}from"./index.d740cb91.js";/* empty css              *//* empty css               */import{u as D}from"./loading.992f9f87.js";import{f as X}from"./vue.6f0b04ed.js";import{f as $e,u as Y}from"./user-info.e23f06cc.js";import"./chart.095b9a7e.js";const we=N({__name:"verification-input-form",props:["input_type","mobile","email","mobile_read_only","email_read_only","code","error_message"],setup($){const r=$,{loading:I,setLoading:f}=D(),{t:v}=J.exports.useI18n(),_=q(),{proxy:i}=oe();let g=r.mobile;r.mobile!==void 0&&(g=`${r.mobile.slice(0,3)}${"*".repeat(6)}${r.mobile.slice(-2)}`);const n=M({mobile:r.mobile_read_only?g:r.mobile,email:r.email_read_only?`${r.mobile.slice(0,3)}${"*".repeat(r.email.length)}`:r.email,code:r.code}),d={updateMobile(t){n.mobile=t,i.$emit("update:mobile",t)},updateEmail(t){n.email=t,i.$emit("update:email",t)},updateCode(t){n.code=t,i.$emit("update:code",t)}},b=M({codeTimer:null,codeInterval:-1}),T=async()=>{try{b.codeInterval=60,b.codeTimer=setInterval(()=>{b.codeInterval>=0?b.codeInterval-=1:clearInterval(b.codeTimer)},1e3),r.input_type==="mobile"?await _.verifyPhone(r.mobile):r.input_type==="email"&&await _.verifyEmail(r.email)}catch{i.$emit("update:error_message.value","(err as Error).message")}finally{f(!1)}},c=[{validator:(t,a)=>new Promise(e=>{r.mobile_read_only||window.setTimeout(()=>{t===""?a(v("login.form.phone.errMsg1")):/1[3,4578][0-9]{9}/.test(t)||a(v("login.form.phone.errMsg2")),e()},1e3)})}],o=[{required:!1,validator:(t,a)=>new Promise(e=>{t=n.email,window.setTimeout(()=>{!/.+@.+\..+/.test(t)&&t!==""?a(i.$t("register.form.email.invalid")):t===_.email&&a(i.$t("change.email.form.errMsg")),e()},1e3)})}],m=[{required:!0,validator:(t,a)=>new Promise(e=>{window.setTimeout(()=>{t=n.code,t===""?a(v("register.form.code.errMsg1")):/\d{6}/.test(t)||a(v("register.form.code.errMsg2")),e()},1e3)})}];return(t,a)=>{const e=_e,S=se,C=ee,O=ge,B=ve,F=j;return p(),V(le,null,[r.input_type==="mobile"?(p(),k(C,{key:0,field:"mobile",rules:c,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[l(S,{modelValue:n.mobile,"onUpdate:modelValue":[a[0]||(a[0]=U=>n.mobile=U),d.updateMobile],placeholder:t.$t("login.form.phone.placeholder"),style:W({"pointer-events":r.mobile_read_only?"none":"auto"})},{prefix:s(()=>[l(e)]),_:1},8,["modelValue","placeholder","style","onUpdate:modelValue"])]),_:1})):x("",!0),r.input_type==="email"?(p(),k(C,{key:1,field:"email",rules:o,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[l(S,{modelValue:n.email,"onUpdate:modelValue":[a[1]||(a[1]=U=>n.email=U),d.updateEmail],placeholder:t.$t("change.form.email.placeholder"),style:W({"pointer-events":r.email_read_only?"none":"auto"})},{prefix:s(()=>[l(O)]),_:1},8,["modelValue","placeholder","style","onUpdate:modelValue"])]),_:1})):x("",!0),l(C,{field:"code",rules:m,"hide-label":""},{default:s(()=>[l(S,{modelValue:n.code,"onUpdate:modelValue":[a[2]||(a[2]=U=>n.code=U),d.updateCode],placeholder:t.$t("login.form.code.placeholder"),"allow-clear":""},{prefix:s(()=>[l(B)]),append:s(()=>[b.codeInterval<0?(p(),k(F,{key:0,type:"primary",onClick:T},{default:s(()=>[w(u(t.$t("login.form.code.buttonText1")),1)]),_:1})):x("",!0),b.codeInterval>=0?(p(),k(F,{key:1},{default:s(()=>[w(u(b.codeInterval+t.$t("register.form.code.buttonText2")),1)]),_:1})):x("",!0)]),_:1},8,["modelValue","placeholder","onUpdate:modelValue"])]),_:1})],64)}}});const z=R(we,[["__scopeId","data-v-4fd072f4"]]),Ie=$=>(te("data-v-f12ca699"),$=$(),ae(),$),ke={class:"login-form-wrapper"},Se={class:"login-form-title"},Ce={class:"login-form-error-msg"},Pe=Ie(()=>y("div",{id:"codeMargin"},null,-1)),Ve=N({__name:"change-password-form",setup($){const r=X(),{t:I}=J.exports.useI18n(),f=E(""),{loading:v,setLoading:_}=D(),i=q();i.setInfo(JSON.parse(localStorage.getItem("userStore")));const{proxy:g}=oe(),n=M({mobile:i.phone,code:"",firstPassword:"",secondPassword:""}),d=E(""),b=E();M({codeTimer:null,codeInterval:-1});const T=async({errors:t,values:a})=>{if(!v.value&&!t){_(!0);try{const e={mobile:n.mobile,code:n.code};await i.verifyCode(e),await Y(i.accountId,L(),{key:n.firstPassword},"password");let S=3,C;const O=G.success({title:"",content:I("change.form.change.success"),okText:I("change.form.return"),onOpen:()=>{C=setInterval(()=>{S>=0?(console.log(S),S-=1):(clearInterval(C),r.back(),O.close())},1e3)},onOk:()=>{clearInterval(C),r.back(),O.close()}})}catch{f.value=I("change.form.change.error"),setTimeout(()=>{f.value=""},5e3)}finally{_(!1)}}},c=[{validator:(t,a)=>new Promise(e=>{window.setTimeout(()=>{t===void 0?a(g.$t("change.form.password.errMsg1")):/^[a-zA-Z0-9_-]{6,32}$/.test(t)?d.value!==""&&t===d.value&&a(g.$t("change.form.password.errMsg3")):a(g.$t("change.form.password.errMsg2")),e(void 0)},1e3)})}],o=[{validator:(t,a)=>new Promise(e=>{window.setTimeout(()=>{t===void 0?a(g.$t("change.form.password_again.errMsg1")):t!==n.firstPassword&&a(g.$t("change.form.password_again.errMsg2")),e(void 0)},1e3)})}],m=()=>{r.back()};return re(async()=>{i.accountId!==void 0&&(d.value=await $e(i.accountId,L()))}),(t,a)=>{const e=he,S=ie,C=ee,O=ye,B=de,F=me,U=ce,Z=H,Q=j,ne=K;return p(),V("div",ke,[y("div",Se,u(t.$t("change.form.title")),1),y("div",Ce,u(f.value),1),l(ne,{ref_key:"changeForm",ref:b,model:n,class:"login-form",layout:"vertical",onSubmit:T},{default:s(()=>[l(z,{input_type:"mobile",mobile:n.mobile,"onUpdate:mobile":[a[0]||(a[0]=h=>n.mobile=h),a[3]||(a[3]=h=>{n.mobile=h})],mobile_read_only:t.$route.params.mobileReadOnly==="1",email_read_only:!1,code:n.code,"onUpdate:code":[a[1]||(a[1]=h=>n.code=h),a[4]||(a[4]=h=>{n.code=h})],error_message:f.value,"onUpdate:error_message":[a[2]||(a[2]=h=>f.value=h),a[5]||(a[5]=h=>{f.value=h})]},null,8,["mobile","mobile_read_only","code","error_message"]),l(C,{field:"firstPassword",rules:c,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[l(S,{modelValue:n.firstPassword,"onUpdate:modelValue":a[6]||(a[6]=h=>n.firstPassword=h),placeholder:t.$t("change.form.password.placeholder")},{prefix:s(()=>[l(e)]),_:1},8,["modelValue","placeholder"])]),_:1}),l(C,{field:"secondPassword",rules:o,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[l(S,{modelValue:n.secondPassword,"onUpdate:modelValue":a[7]||(a[7]=h=>n.secondPassword=h),type:"password",placeholder:t.$t("change.form.password_again.placeholder")},{prefix:s(()=>[l(O)]),_:1},8,["modelValue","placeholder"])]),_:1}),l(Z,{size:5,direction:"vertical"},{default:s(()=>[l(U,{class:"row"},{default:s(()=>[l(F,{span:2},{default:s(()=>[l(B)]),_:1}),l(F,{span:22},{default:s(()=>[y("span",null,u(t.$t("login.form.rule")),1)]),_:1})]),_:1}),l(U,{class:"row"},{default:s(()=>[l(F,{span:2},{default:s(()=>[l(B)]),_:1}),l(F,{span:22},{default:s(()=>[y("span",null,u(t.$t("login.form.hint")),1)]),_:1})]),_:1})]),_:1}),l(Z,{size:16,direction:"vertical"},{default:s(()=>[Pe,l(Q,{type:"primary","html-type":"submit",long:"",loading:P(v)},{default:s(()=>[w(u(t.$t("change.form.acknowledge")),1)]),_:1},8,["loading"]),l(Q,{type:"text",long:"",class:"login-form-register-btn",onClick:m},{default:s(()=>[w(u(t.$t("change.form.return")),1)]),_:1})]),_:1})]),_:1},8,["model"])])}}});const Ue=R(Ve,[["__scopeId","data-v-f12ca699"]]),Me={class:"change-phone-form-wrapper"},Te={class:"change-phone-form-title"},Fe={key:0,class:"change-phone-form-sub-title"},xe={key:1,class:"change-phone-form-sub-title"},Ee={class:"change-phone-form-error-msg"},Oe=N({__name:"change-phone-form",setup($){const r=X(),{t:I}=J.exports.useI18n(),{loading:f,setLoading:v}=D(),_=q(),i=E(""),g=E(!1);_.setInfo(JSON.parse(localStorage.getItem("userStore")));const n=M({phone:_.phone,code:""}),d=M({phone:"",code:""}),b=async({errors:c,values:o})=>{if(!f.value&&!c){v(!0);try{await A({mobile:n.phone,code:n.code}),g.value=!0,i.value=""}catch(m){i.value=m.message,g.value=!1}finally{v(!1)}}},T=async({errors:c,values:o})=>{if(!f.value&&!c){v(!0);try{await A({mobile:d.phone,code:d.code}),await Y(_.accountId,L(),{key:d.phone},"mobile"),_.phone=d.phone,localStorage.setItem("userStore",JSON.stringify(_.$state));let m=3,t;const a=G.success({title:" ",content:I("change.phone.form.success"),okText:I("change.phone.form.back"),onOpen:()=>{t=setInterval(()=>{m>=0?(console.log(m),m-=1):(clearInterval(t),r.push({name:"Setting"}),a.close())},1e3)},onOk:()=>{clearInterval(t),r.push({name:"Setting"}),a.close()},bodyStyle:"display: flex; align-items: center; justify-content: center; font-size: 24px;"})}catch(m){i.value=m.message}finally{v(!1)}}};return(c,o)=>{const m=j,t=H,a=K;return p(),V("div",Me,[y("div",Te,u(c.$t("change.phone.form.title")),1),g.value?(p(),V("div",xe,u(c.$t("change.phone.form.subtitle2")),1)):(p(),V("div",Fe,u(c.$t("change.phone.form.subtitle1")),1)),y("div",Ee,u(i.value),1),g.value?(p(),k(a,{key:3,model:d,layout:"vertical"},{default:s(()=>[l(z,{input_type:"mobile",mobile:d.phone,"onUpdate:mobile":[o[6]||(o[6]=e=>d.phone=e),o[9]||(o[9]=e=>{d.mobile=e})],mobile_read_only:!1,email_read_only:!1,code:d.code,"onUpdate:code":[o[7]||(o[7]=e=>d.code=e),o[10]||(o[10]=e=>{d.code=e})],error_message:i.value,"onUpdate:error_message":[o[8]||(o[8]=e=>i.value=e),o[11]||(o[11]=e=>{i.value=e})]},null,8,["mobile","code","error_message"]),l(t,{size:16,direction:"vertical"},{default:s(()=>[l(m,{type:"primary",onClick:T,long:"",loading:P(f)},{default:s(()=>[w(u(c.$t("change.phone.form.change")),1)]),_:1},8,["loading"]),l(m,{type:"text",onClick:o[12]||(o[12]=e=>{P(r).push({name:"Setting"})}),long:"",class:"change-phone-form-back-btn"},{default:s(()=>[w(u(c.$t("change.phone.form.back")),1)]),_:1})]),_:1})]),_:1},8,["model"])):(p(),k(a,{key:2,model:n,layout:"vertical"},{default:s(()=>[l(z,{input_type:"mobile",mobile:n.phone,"onUpdate:mobile":o[0]||(o[0]=e=>n.phone=e),mobile_read_only:!0,email_read_only:!1,code:n.code,"onUpdate:code":[o[1]||(o[1]=e=>n.code=e),o[3]||(o[3]=e=>{n.code=e})],error_message:i.value,"onUpdate:error_message":[o[2]||(o[2]=e=>i.value=e),o[4]||(o[4]=e=>{i.value=e})]},null,8,["mobile","code","error_message"]),l(t,{size:16,direction:"vertical"},{default:s(()=>[l(m,{type:"primary",onClick:b,long:"",loading:P(f)},{default:s(()=>[w(u(c.$t("change.phone.form.verify")),1)]),_:1},8,["loading"]),l(m,{type:"text",onClick:o[5]||(o[5]=e=>{P(r).push({name:"Setting"})}),long:"",class:"change-phone-form-back-btn"},{default:s(()=>[w(u(c.$t("change.phone.form.back")),1)]),_:1})]),_:1})]),_:1},8,["model"]))])}}});const ze=R(Oe,[["__scopeId","data-v-e984937a"]]),Ne={class:"change-email-form-wrapper"},Re={class:"change-email-form-title"},Be={key:0,class:"change-email-form-sub-title"},Le={key:1,class:"change-email-form-sub-title"},je={class:"change-email-form-error-msg"},Je=N({__name:"change-email-form",setup($){const r=X(),{t:I}=J.exports.useI18n(),{loading:f,setLoading:v}=D(),_=q(),i=E(""),g=E(!1);_.setInfo(JSON.parse(localStorage.getItem("userStore")));const n=M({phone:_.phone,code:""}),d=M({email:"",code:""}),b=async({errors:c,values:o})=>{if(!f.value&&!c){v(!0);try{await A({mobile:n.phone,code:n.code}),g.value=!0,i.value=""}catch(m){i.value=m.message,g.value=!1}finally{v(!1)}}},T=async({errors:c,values:o})=>{if(!f.value&&!c){v(!0);try{await be({email:d.email,code:d.code}),await Y(_.accountId,L(),{key:d.email},"email"),_.email=d.email,localStorage.setItem("userStore",JSON.stringify(_.$state));let m=3,t;const a=G.success({title:" ",content:I("change.phone.form.success"),okText:I("change.phone.form.back"),onOpen:()=>{t=setInterval(()=>{m>=0?(console.log(m),m-=1):(clearInterval(t),r.push({name:"Setting"}),a.close())},1e3)},onOk:()=>{clearInterval(t),r.push({name:"Setting"}),a.close()},bodyStyle:"display: flex; align-items: center; justify-content: center; font-size: 24px;"})}catch(m){i.value=m.message}finally{v(!1)}}};return(c,o)=>{const m=j,t=H,a=K;return p(),V("div",Ne,[y("div",Re,u(c.$t("change.email.form.title")),1),g.value?(p(),V("div",Le,u(c.$t("change.email.form.subtitle2")),1)):(p(),V("div",Be,u(c.$t("change.email.form.subtitle1")),1)),y("div",je,u(i.value),1),g.value?(p(),k(a,{key:3,model:d,layout:"vertical"},{default:s(()=>[l(z,{input_type:"email",email:d.email,"onUpdate:email":[o[6]||(o[6]=e=>d.email=e),o[9]||(o[9]=e=>{d.email=e})],mobile_read_only:!1,email_read_only:!1,code:d.code,"onUpdate:code":[o[7]||(o[7]=e=>d.code=e),o[10]||(o[10]=e=>{d.code=e})],error_message:i.value,"onUpdate:error_message":[o[8]||(o[8]=e=>i.value=e),o[11]||(o[11]=e=>{i.value=e})]},null,8,["email","code","error_message"]),l(t,{size:16,direction:"vertical"},{default:s(()=>[l(m,{type:"primary",onClick:T,long:"",loading:P(f)},{default:s(()=>[w(u(c.$t("change.phone.form.change")),1)]),_:1},8,["loading"]),l(m,{type:"text",onClick:o[12]||(o[12]=e=>{P(r).push({name:"Setting"})}),long:"",class:"change-phone-form-back-btn"},{default:s(()=>[w(u(c.$t("change.phone.form.back")),1)]),_:1})]),_:1})]),_:1},8,["model"])):(p(),k(a,{key:2,model:n,layout:"vertical"},{default:s(()=>[l(z,{input_type:"mobile",mobile:n.phone,"onUpdate:mobile":o[0]||(o[0]=e=>n.phone=e),mobile_read_only:!0,email_read_only:!1,code:n.code,"onUpdate:code":[o[1]||(o[1]=e=>n.code=e),o[3]||(o[3]=e=>{n.code=e})],error_message:i.value,"onUpdate:error_message":[o[2]||(o[2]=e=>i.value=e),o[4]||(o[4]=e=>{i.value=e})]},null,8,["mobile","code","error_message"]),l(t,{size:16,direction:"vertical"},{default:s(()=>[l(m,{type:"primary",onClick:b,long:"",loading:P(f)},{default:s(()=>[w(u(c.$t("change.phone.form.verify")),1)]),_:1},8,["loading"]),l(m,{type:"text",onClick:o[5]||(o[5]=e=>{P(r).push({name:"Setting"})}),long:"",class:"change-phone-form-back-btn"},{default:s(()=>[w(u(c.$t("change.phone.form.back")),1)]),_:1})]),_:1})]),_:1},8,["model"]))])}}});const qe=R(Je,[["__scopeId","data-v-b7b26d41"]]),De=$=>(te("data-v-2b6ab7b7"),$=$(),ae(),$),Ae={class:"container"},Ge=De(()=>y("div",{class:"logo"},[y("img",{alt:"logo",src:pe}),y("div",{class:"logo-text"},"Model Valhalla")],-1)),He={class:"content"},Ke={class:"content-inner"},Xe={class:"footer"},Ye=N({__name:"index",setup($){return(r,I)=>(p(),V("div",Ae,[Ge,l(ue),y("div",He,[y("div",Ke,[r.$route.params.toChange==="password"?(p(),k(Ue,{key:0})):x("",!0),r.$route.params.toChange==="phone"?(p(),k(ze,{key:1})):x("",!0),r.$route.params.toChange==="email"?(p(),k(qe,{key:2})):x("",!0)]),y("div",Xe,[l(fe)])])]))}});const ro=R(Ye,[["__scopeId","data-v-2b6ab7b7"]]);export{ro as default};
